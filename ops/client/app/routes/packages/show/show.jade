.hbox.accounts#packageShow
  .col.bg-white-only.w-md.b-r
    .wrapper-xs.m-sm(style='width: 93%;')
      .pull-right
        a.col.v-middle(style='width: 2em;')
        a.col.v-middle(
        ng-show='-1 !== $ctrl.editAllowedStates.indexOf($ctrl.data.state_id)'
        ui-sref="customer.package.update({ id: $ctrl.data.Customer.id, packageId: $ctrl.data.id })"
        style='width: 2em;'
        ): i.m-t-sm.wrapper-xs.fa.fa-edit(title='Edit Package')
        a.col.v-middle(
        ng-show='-1 !== $ctrl.editAllowedStates.indexOf($ctrl.data.state_id)'
        ng-click="$ctrl.deletePackage($ctrl.$stateParams.id)"
        style='width: 2em;'
        ): i.m-t-sm.wrapper-xs.fa.fa-trash(title='Delete Package')
        .col.hide.v-middle(uib-dropdown='')
          a(href='' style='width: 2em;' ): i.m-t-sm.wrapper-xs.fa.fa-ellipsis-v(uib-dropdown-toggle='')
          ul.m-r-xl.dropdown-menu(
          uib-dropdown-menu=''
          role='menu'
          aria-labelledby='single-button' style='right: -35px; left: auto;'
          )
            li(role='menuitem' title='Send package details to customer')
              a.col.v-middle(ng-click='$ctrl.sendNotificaton()' target='_blank') Send Notification
      .wrapper-xs.v-middle
        .h4.wrapper-xs.text-ellipsis.text-dark(title='{{$ctrl.data.Store.name}}')
          i.fa.fa-check-circle-o.m-r-xs.text-success(
          name='package_confirm'
          title='Package Confirm' ng-if='1 || $ctrl.data.package_confirmed'
          )
          span(ng-bind='$ctrl.data.Store.name')

      .m-l-sm
        .hbox(uib-dropdown='' uib-keyboard-nav='' dropdown-append-to-body)
          button.btn.btn-sm.padder.rounded(
          class='btn-{{App.states[$ctrl.data.state_id].config.color}}'
          uib-dropdown-toggle=''
          ng-disabled='App.states[$ctrl.data.state_id].Actions.length===0'
          )
            span.m-r-xs(ng-bind='App.states[$ctrl.data.state_id].action')
            span(ng-if='App.states[$ctrl.data.state_id].Actions.length>0').caret

          ul.dropdown-menu(uib-dropdown-menu role="menu" aria-labelledby="simple-btn-keyboard-nav")
            li(role='menuitem' ng-repeat='state in App.states[$ctrl.data.state_id].Actions' ng-if="App.states[state.state_id].action")
              a(
              href=''
              ng-click='$ctrl.ChangeState.open($ctrl.data, state.state_id, $ctrl.data.Customer.id)' ng-bind='::App.states[state.state_id].action')
      .m-l-sm.m-t-xs(title='Interview Time' ng-if='$ctrl.data._root_.is_drive && $ctrl.data.interview_time')
        i.fa.fa-calendar.m-r-sm
        span.text-md.text-primary(ng-bind="$ctrl.data.created_at | date : 'MMM d, yyyy'")
    .wrapper-xs.m-l-sm(ng-if='$ctrl.data.comments' ng-show='$ctrl.data.summary')
      .hbox(style="width: 97%")
        .row
          .wrapper-xs.sticky-note
            .wrapper-xs.sticky-heading(style="width: 97%")
              div(ng-bind='$ctrl.data.summary' ng-class='{ "show": !$ctrl.ui.show }')
              a.pull-right.wrapper-xs(
              ng-click='$ctrl.ui.show = !$ctrl.ui.show'
              ng-bind='$ctrl.ui.show ? "Show Less" : "Show More"'
              ng-show='$ctrl.data.summary.length > 100'
              )

    //- Package Employee Information
    .wrapper-xs.m-l-sm.m-t-sm.b-t
      uib-tabset(active='activeTab')
        uib-tab(index='0' heading='Info')
          .clear.wrapper-xs(ng-if='$ctrl.data.invoice_code')
            a.h4.text-center.m-r-xs.pull-left.thumb-xs.no-border.m-t-sm
              i.fa.fa-barcode.text-muted.fa-lg
            div
              a.text-xs.text-muted Invoice Code
              div(ng-bind='$ctrl.data.invoice_code')

          .clear.wrapper-xs(ng-if='$ctrl.data.weight')
            a.h4.text-center.m-r-xs.pull-left.thumb-xs.no-border.m-t-sm
              i.fa.fa-balance-scale.text-muted.fa-lg
            div
              a.text-muted.font-thin Weight
              div(ng-bind='$ctrl.data.weight')

          .clear.wrapper-xs(ng-if='$ctrl.data.is_doc')
            a.h4.text-center.m-r-xs.pull-left.thumb-xs.no-border.m-t-sm
              i.fa.text-muted.fa-lg(ng-class="$ctrl.data.is_doc ? 'fa-book' : 'fa-archive'")
            div
              a.text-muted.font-thin Consignment Type
              div(ng-bind="$ctrl.data.is_doc ? 'Document' : 'Non Document'")

          .clear.wrapper-xs(ng-if='$ctrl.data.content_type')
            a.h4.text-center.m-r-xs.pull-left.thumb-xs.no-border.m-t-sm
              i.fa.text-muted.fa-lg.fa-tint
            div
              a.text-muted.font-thin Content Type
              div(ng-bind="$ctrl.data.content_type === '1' ? 'Normal' : 'Special'")

          .clear.wrapper-xs
            a.h4.text-center.m-r-xs.pull-left.thumb-xs.no-border.m-t-sm
              i.fa.fa-cubes.text-muted.fa-lg
            div
              a.text-muted.font-thin Number of Items
              div(ng-bind='$ctrl.data.PackageItems.length ||0')

          .clear.wrapper-xs(ng-if='$ctrl.data.price_amount')
            a.h4.text-center.m-r-xs.pull-left.thumb-xs.no-border.m-t-sm
              i.fa.fa-inr.text-muted.fa-lg
            div
              a.text-muted.font-thin Price
              div
                span(ng-bind='$ctrl.data.price_amount')

          .clear.wrapper-xs(ng-if='$ctrl.data.splitting_directions')
            a.h4.text-center.m-r-xs.pull-left.thumb-xs.no-border.m-t-sm
              i.fa.fa-comment.text-muted.fa-lg
            div.text-danger
              a.text-muted.font-thin Split Message
              div
                span(ng-bind='$ctrl.data.splitting_directions')

          .clear.wrapper-xs(ng-if='$ctrl.data.return_send')
            a.h4.text-center.m-r-xs.pull-left.thumb-xs.no-border.m-t-sm
              i.fa.fa-comment.text-muted.fa-lg
            div.text-danger
              a.text-muted.font-thin Return to Sender
              div
                span(ng-bind='$ctrl.data.return_send')

          .clear.wrapper-xs(
          uib-tooltip="{{$ctrl.data.created_at | date:'MMM d, y'}} IST {{$ctrl.data.created_at | date:'h:mm a'}}"
          tooltip-placement='right'
          tooltip-append-to-body='true'
          )
            a.h4.text-center.m-r-xs.pull-left.thumb-xs.no-border.m-t-sm
              i.fa.fa-clock-o.text-muted.fa-lg
            div
              a.text-muted.font-thin Date & Time of Receive
              div
                span(ng-bind='$ctrl.moment($ctrl.data.created_at).fromNow()')

        uib-tab(index='1' heading='Charges(₹)' select='$ctrl.getCharges()')
          a.pull-right(
            ui-sref="package.charges({ id: $ctrl.data.id, customerId: $ctrl.$stateParams.id })"
            style='width: 2em;'
          ): i.m-t-sm.wrapper-xs.fa.fa-edit(title='Edit Package Charges')
          .clear.wrapper-xs(ng-if='charge.chargeAmount' ng-repeat="charge in $ctrl.charges")
            a.h4.text-center.m-r-xs.pull-left.thumb-xs.no-border.m-t-sm
              i.fa.text-muted.fa-lg(ng-class="$ctrl.chargesIcon[charge.key]")
            div
              a.text-muted.font-thin(ng-bind='charge.label')
              div
                span(ng-bind='"₹" + charge.chargeAmount')


        uib-tab(index='2', heading='Docs')
          .col-xs-12.wrapper-xs.no-padder-left(ng-if='$ctrl.document.length')
            .w-full.wrapper-xs.inline(ng-repeat='(key, file) in $ctrl.document')
              .m-b-xs.wrapper-xs.clear(ng-class="$last ?'':'b-b'")
                i.fa.fa-file.m-r-sm.pull-left.m-t-xs
                a.text-ellipsis.w.m-l-xs.inline(ng-bind='file.filename' ng-href="{{file.link}}" target='_blank')
                a.pull-right
                  i.fa.fa-close(ng-click='$ctrl.deleteDocument(file.id, key)')
          .col-xs-12.wrapper-xs.hide
            label.text-center.m-t-sm.w-full.b-a.bg-light.wrapper-xs(for="uploadCV")
              .w-full(for="uploadCV")
                i.fa.fa-plus.m-r-sm
              label.m-b-none(for="uploadCV"): .pos-rlt(
              uib-tooltip='You can upload Documents'
              tooltip-placement='bottom'
              )
                span Add/Upload Document
                p.h6 Documents/Spreadsheets/Images/ZIP
              input.form.form-control.btn.w-lg.pos-abt(
              id="uploadCV"
              type='file'
              name='documentfile'
              maxsize='5000'
              ng-model='$ctrl.documentfile'
              style='display:none !important'
              accept=".pdf, .pdf, .doc, .docx, .rtf, .txt. xls, xlsx"
              ng-change='$ctrl.uploadFiles($ctrl.documentfile)'
              multiple base-sixty-four-input
              )
          div(ng-show= '$ctrl.data.invoice')
            h4 Customer invoice
            a(href ='{{$ctrl.URLS.CDN + "/shoppre/" + $ctrl.data.invoice}}' target = '_blank')
              img.pull-left.m-r(
              ng-src='{{$ctrl.URLS.CDN + "/shoppre/" + $ctrl.data.invoice}}'
              style='height: 80px;width: 80px;'
              )
  .col
    div
      .hbox
        div
          .bg-white-only.b-b(style='position: fixed;width: 100%; height: 44px;')
            ul.nav.nav-pills.nav-sm.m-t-xs
              li(ng-repeat='bucket in $ctrl.buckets' ui-sref-active="active")
                a(ui-sref='packages.index({jobId:$ctrl.job.id, bucket: bucket })' ng-bind="bucket" ng-hide="bucket == 'Bookmarked' && App.app.settings.isAdmin")
          .wrapper-xs.bg-light(style='position: fixed; right: 0;background: #fff; z-index: 3;width:30%;')
            .pull-right.col.m-r-xs.m-t-xs(ng-if='$ctrl.packages.length') {{$ctrl.packages.length}} of {{$ctrl.total}} Packages(s)
            .pull-right.col.pointer.m-r-xs(ng-click='$ctrl.ExcelDownload.download($ctrl.params)')
              button.btn.btn-sm.btn-default
                span.fa.fa-file-excel-o
            .pull-right.col.pointer.m-r-xs(ng-click='$ctrl.openPackageFilter()')
              button.btn.btn-sm.btn-default
                span.fa.fa-filter
            .pull-right.col.pointer.m-r-xs
              uib-dropdown
                button.btn.btn-sm.btn-default(type='button', uib-dropdown-toggle='', aria-haspopup='true', aria-expanded='false')
                  | {{ ($ctrl.sorts | filter:{ key: $ctrl.params.sort }: true)[0].name !== 'Default' ? ($ctrl.sorts | filter:{ key: $ctrl.params.sort }: true)[0].name+'&nbsp;&nbsp;' : '' }}
                  span.fa.fa-sort-alpha-asc
                ul.dropdown-menu.pull-right(uib-dropdown-menu='', role='menu', aria-labelledby='btn-append-to-body')
                  li(ng-repeat="sort in $ctrl.sorts")
                    a(href='#' ng-bind='sort.name' ng-click='$ctrl.sort(sort.key)')
          customer-header.bg-white-only.w-full.b-b(customer="$ctrl.customer" style='position: fixed;z-index: 6;height: 40px;')
          directive-header(
            options="$ctrl"
            buttons="{packageCreate: $ctrl.packageItemsAdditionAllowedStateIds.includes($ctrl.data.state_id)}"
            App="App"
          )
        .m-t-xl(style='padding-bottom: 4px;')
        .row
          .col-md-8.no-padder-right
            scrollable-table.no-padder.col-md-11(table-offset="110")
              table.table.m-b-none
                thead
                  tr
                    th.col-xs-2 Name
                    th.col-xs-2 Category
                    th.col-xs-2 Quantity
                    th.col-xs-2 Price
                    th.col-xs-2 Total Amount
                    th.col-xs-2 DeletePackage

              .col-xs-12(style='padding: 10px;')
                .col-xs-12(ng-show='$ctrl.packageItems.length === 0 && !$ctrl.ui.loading')
                  td(colspan="5")
                    h1.text-center.text-muted No Items in Package
                    .text-center: ul.nav.nav-pills.nav-sm.center-pills
                      li.m-r-xs
                        a.h5.font-bold.b-a.btn-addon.btn-success.text-white-only.b-success.imp(
                        ui-sref='package.items({ id: $ctrl.$stateParams.id })'
                        popover-trigger="'mouseenter'"
                        popover-placement='bottom'
                        popover-append-to-body='true'
                        )
                          span  Start Adding Items
                .col-xs-12.no-padder.bg-white.b-a.m-b-sm(ng-repeat='packageItem in $ctrl.packageItems')
                  .col-xs-2.wrapper-sm.m-t-xs
                    img.pull-left.m-r(

                      ng-src='{{$ctrl.URLS.CDN + "/shoppre/" + packageItem.object.replace(".", "-thumb.")}}'
                      style='height: 30px;width: 30px;border-radius: 50%;'
                    )
                    a(ui-sref='package.item.edit({ id: $ctrl.$stateParams.id , packageItemId: packageItem.id })' target="_blank") {{packageItem.name}}
                  .col-xs-2.wrapper-sm.text-ellipsis.m-t-xs(ng-bind='packageItem.PackageItemCategory.name')
                  .col-xs-2.wrapper-sm.text-ellipsis.m-t-xs(title="{{packageItem.quantity}}" ng-bind="packageItem.quantity + 'pc'")
                  .col-xs-2.wrapper-sm.text-ellipsis.m-t-xs(ng-bind="'₹' + packageItem.price_amount" title="{{packageItem.price_amount}}")
                  .col-xs-2.wrapper-sm.text-ellipsis.m-t-xs(ng-bind="'₹' + packageItem.total_amount" title="{{packageItem.total_amount}}")
                  .col-xs-2.wrapper-sm.text-ellipsis.m-t-xs.fa.fa-trash(ng-click="$ctrl.deletePackageItem($ctrl.$stateParams.id, packageItem.id, $index)")


                .col-xs-12.text-center
                  a.btn.active.m-t-xs(ng-if="$ctrl.ui.loading")
                    i.fa.fa-circle-o-notch.fa-spin
                    strong &nbsp;Loading
                  a.btn.btn-primary.m-t-xs(ng-if="$ctrl.ui.lazyLoad" ng-click="$ctrl.loadPackages()")
                    i.fa.fa-plus-circle
                    strong &nbsp;Load More
          .col-md-3
            .nav-comment.col-md-4.bg-white-only.no-padder
              span.bg-info(style="padding: 10px;z-index:1; position:absolute; right:0" title="{{$ctrl.chatHoverText()}}" ng-click="App.initiateChat($ctrl.data)")
                img(src="assets/images/chat.png" height="20px" width="20px")
              comments(id='{{$ctrl.$stateParams.id}}' data='$ctrl.data' type='"package"')
